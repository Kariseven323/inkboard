# 砚记(Inkboard) - 敏捷开发计划与Sprint规划

## 1. 敏捷开发概述

### 1.1 敏捷开发原则
砚记项目遵循敏捷开发宣言的核心价值观：
- **个体和互动** 胜过流程和工具
- **工作的软件** 胜过详尽的文档
- **客户合作** 胜过合同谈判
- **响应变化** 胜过遵循计划

### 1.2 项目特点
- **团队规模**: 1人（个人项目）
- **开发周期**: 预计3个月（12周）
- **Sprint周期**: 2周一个Sprint，共6个Sprint
- **发布策略**: MVP → 增量发布 → 完整版本

### 1.3 成功定义
- 完成核心CRUD功能
- 实现Facebook风格UI设计
- 达到iOS原生动效体验
- 测试覆盖率 > 90%
- 应用性能指标达标

## 2. 项目时间线

### 2.1 整体时间线（已调整为UI优先策略）
```
周次    Sprint    目标                           状态
1-2     Sprint 1  项目基础设置 + UI框架搭建      🔄 进行中
3-4     Sprint 2  Facebook风格首页完整实现       🔄 进行中
5-6     Sprint 3  核心数据层开发                ✅ 已完成
7-8     Sprint 4  日记CRUD功能集成到UI界面       ✅ 已完成
9-10    Sprint 5  搜索和标签功能                ✅ 已完成
11-12   Sprint 6  动画效果、优化和发布准备       ✅ 已完成
```

### 2.2 里程碑（UI优先开发策略）
- **Week 2**: 项目架构 + 基础UI框架完成
- **Week 4**: Facebook风格首页完全实现
- **Week 6**: 数据层和业务逻辑完成
- **Week 8**: 功能UI集成，MVP版本完成
- **Week 10**: 高级功能和搜索完成
- **Week 12**: 动画效果优化，正式版本发布

## 3. Sprint详细规划

### 3.1 Sprint 1: 项目基础设置 + UI框架搭建 (Week 1-2)
**Sprint目标**: 搭建项目基础架构，建立开发环境，创建Facebook风格的UI框架

#### 3.1.1 Story Points估算
总估算: 45 Story Points

#### 3.1.2 产品待办事项 (Product Backlog)

| ID | 用户故事 | 验收标准 | 估算(SP) | 优先级 |
|----|----------|----------|----------|--------|
| INK-001 | 作为开发者，我需要搭建Flutter项目基础架构 | 项目结构清晰，依赖配置完成 | 8 | High |
| INK-002 | 作为开发者，我需要配置代码质量工具 | Linting规则配置，代码格式化工具就绪 | 5 | High |
| INK-003 | 作为开发者，我需要建立依赖注入框架 | get_it + injectable配置完成 | 8 | High |
| INK-004 | 作为开发者，我需要配置状态管理 | Riverpod基础配置完成 | 5 | High |
| INK-032 | 作为开发者，我需要建立Facebook风格的设计系统 | 颜色主题、文字样式、组件库基础 | 8 | High |
| INK-033 | 作为开发者，我需要创建主布局框架 | 三栏布局结构（左导航、主内容、右栏） | 8 | High |
| INK-006 | 作为开发者，我需要建立测试框架 | 单元测试、Widget测试、集成测试环境就绪 | 3 | Medium |

#### 3.1.3 Sprint待办事项 (Sprint Backlog)
- [x] 创建Flutter项目结构
- [x] 编写项目文档（PRD、架构设计等）
- [x] 配置依赖注入框架
- [x] 设置Riverpod状态管理
- [x] **新增：创建Facebook风格设计系统**
- [x] **新增：实现主布局框架（三栏布局）**
- [x] 配置测试环境
- [x] 设置CI/CD流水线（可选）

#### 3.1.4 Definition of Done
- [x] 所有代码通过静态分析
- [x] 单元测试覆盖率 > 90%
- [ ] 代码Review完成
- [x] 文档更新完成
- [ ] 功能演示完成

### 3.2 Sprint 2: Facebook风格首页完整实现 (Week 3-4)
**Sprint目标**: 完全照抄Facebook首页设计，实现所有UI组件和布局

#### 3.2.1 产品待办事项

| ID | 用户故事 | 验收标准 | 估算(SP) | 优先级 |
|----|----------|----------|----------|--------|
| INK-034 | 作为用户，我需要Facebook风格的顶部导航栏 | Logo、搜索框、右侧图标菜单完全还原 | 13 | High |
| INK-035 | 作为用户，我需要Facebook风格的左侧导航菜单 | 导航项目、图标、悬停效果完全还原 | 13 | High |
| INK-036 | 作为用户，我需要Facebook风格的主内容发布区 | "你在想什么？"输入框及功能按钮 | 8 | High |
| INK-037 | 作为用户，我需要Facebook风格的内容卡片 | 时间线卡片布局、头像、用户名、时间等 | 13 | High |
| INK-038 | 作为用户，我需要Facebook风格的右侧栏 | 联系人列表、推荐内容等侧边栏组件 | 8 | High |
| INK-039 | 作为开发者，我需要实现响应式布局 | 适配不同屏幕尺寸，保持Facebook风格 | 5 | Medium |

#### 3.2.2 技术任务
- Facebook蓝色主题色彩系统实现 (#1877F2, #F0F2F5等)
- 卡片阴影和圆角样式完全还原
- 字体和图标系统实现
- 悬停和点击效果实现
- 响应式断点设置
- 组件状态管理集成

#### 3.2.3 Facebook设计规范要求
**必须完全照抄的设计元素：**
- 顶部导航栏：44px高度，#1877F2背景色
- 搜索框：圆角20px，#F0F2F5背景
- 卡片：圆角8px，1px边框 #E4E6EA，阴影 0 1px 2px rgba(0,0,0,0.1)
- 左侧菜单：16px图标，Helvetica字体，#050505文字色
- 间距系统：4px基础单位，16px标准间距
- 用户头像：圆形，32px（小）/40px（中）/56px（大）
- 按钮：圆角6px，#1877F2主色，#42B883辅助色

### 3.3 Sprint 3: 核心数据层开发 (Week 5-6)
**Sprint目标**: 完成数据层和业务逻辑层开发（移到UI完成后）

#### 3.3.1 产品待办事项

| ID | 用户故事 | 验收标准 | 估算(SP) | 优先级 |
|----|----------|----------|----------|--------|
| INK-005 | 作为开发者，我需要建立数据库基础 | drift数据库配置完成，基础表结构创建 | 8 | High |
| INK-007 | 作为开发者，我需要实现DiaryEntry实体和Repository | 完整的CRUD操作，包含测试 | 13 | High |
| INK-008 | 作为开发者，我需要实现Tag实体和Repository | 标签管理功能，包含测试 | 8 | High |
| INK-009 | 作为开发者，我需要实现搜索功能 | 全文搜索，支持标题和内容搜索 | 8 | High |
| INK-010 | 作为开发者，我需要实现数据加密 | 数据库加密，安全存储 | 5 | Medium |
| INK-011 | 作为开发者，我需要实现Use Cases | 所有业务逻辑用例，包含验证 | 8 | High |

#### 3.3.2 技术任务
- 数据库表结构实现
- Repository模式实现
- 数据模型和实体映射
- 业务逻辑用例开发
- 数据验证和错误处理
- 数据迁移策略

### 3.4 Sprint 4: 日记CRUD功能集成到UI界面 (Week 7-8)
**Sprint目标**: 将数据层功能集成到Facebook风格界面中

#### 3.4.1 产品待办事项

| ID | 用户故事 | 验收标准 | 估算(SP) | 优先级 |
|----|----------|----------|----------|--------|
| INK-012 | 作为用户，我需要在Facebook风格界面中浏览日记列表 | 时间线式列表，卡片布局集成数据 | 13 | High |
| INK-013 | 作为用户，我需要在发布区创建新的日记 | 模拟Facebook发布框，集成Markdown编辑 | 13 | High |
| INK-014 | 作为用户，我需要编辑已有的日记 | 编辑页面，实时预览，保持Facebook风格 | 8 | High |
| INK-015 | 作为用户，我需要删除不需要的日记 | Facebook风格的操作菜单和确认对话框 | 5 | High |
| INK-016 | 作为用户，我需要应用主题系统 | Facebook亮暗主题切换，Material 3集成 | 8 | Medium |
| INK-040 | 作为用户，我需要数据持久化 | 所有日记操作正确保存到数据库 | 5 | High |

#### 3.4.2 UI组件开发
- Facebook风格日记卡片组件（集成真实数据）
- Markdown编辑器组件（Facebook风格）
- 导航栏功能集成
- 通用对话框组件（Facebook风格）
- 加载和错误状态组件

### 3.5 Sprint 5: 搜索和标签功能 (Week 9-10)
**Sprint目标**: 增强用户体验，添加高级功能

#### 3.5.1 产品待办事项

| ID | 用户故事 | 验收标准 | 估算(SP) | 优先级 |
|----|----------|----------|----------|--------|
| INK-017 | 作为用户，我需要在Facebook风格界面中搜索日记内容 | 全局搜索，结果高亮，Facebook搜索框风格 | 13 | High |
| INK-018 | 作为用户，我需要使用标签管理日记 | 标签创建、关联、筛选，Facebook标签风格 | 13 | High |
| INK-019 | 作为用户，我需要收藏重要的日记 | 收藏功能，收藏列表，Facebook点赞风格 | 5 | Medium |
| INK-020 | 作为用户，我需要按日期筛选日记 | 日期选择器，时间范围筛选 | 8 | Medium |
| INK-021 | 作为用户，我需要导出日记数据 | Markdown格式导出 | 8 | Low |

### 3.6 Sprint 6: 动画效果、优化和发布准备 (Week 11-12)
**Sprint目标**: 实现iOS动效，性能优化，发布准备

#### 3.6.1 产品待办事项

| ID | 用户故事 | 验收标准 | 估算(SP) | 优先级 |
|----|----------|----------|----------|--------|
| INK-022 | 作为用户，我需要流畅的页面切换动画 | Hero动画，页面转场效果，iOS风格 | 13 | High |
| INK-023 | 作为用户，我需要优雅的列表动画 | 列表项动画，加载动画，Facebook风格 | 8 | High |
| INK-024 | 作为用户，我需要手势操作支持 | 滑动操作，长按菜单，iOS交互体验 | 8 | Medium |
| INK-025 | 作为用户，我需要触觉反馈 | 按钮点击，操作确认反馈 | 3 | Low |
| INK-027 | 作为开发者，我需要优化应用性能 | 启动时间<3s，内存使用<100MB | 13 | High |
| INK-028 | 作为开发者，我需要完善测试覆盖 | 测试覆盖率>80%，关键路径100% | 13 | High |
| INK-029 | 作为用户，我需要应用设置页面 | 主题、字体、导出等设置，Facebook风格 | 8 | Medium |
| INK-030 | 作为开发者，我需要应用图标和启动页 | 应用图标设计，启动页动画 | 5 | Medium |
| INK-031 | 作为开发者，我需要发布准备 | 应用签名，发布包生成 | 3 | High |

#### 3.6.3 完成情况与说明
- 已实现：
  - iOS风格页面转场（CupertinoPageRoute）与Hero共享元素（卡片头像/标题 -> 编辑页）。
  - 列表项入场动画（轻量淡入+位移），滑动删除（Dismissible，含确认对话框）。
  - 长按弹出操作菜单（编辑/收藏/删除），关键操作触觉反馈（HapticFeedback）。
  - 新增设置页（主题切换、字体缩放、导出入口），字体缩放支持全局TextScaler。
  - 发布准备：新增flutter_launcher_icons与flutter_native_splash配置占位，并在pubspec.yaml中提供示例配置。
- 待后续：
  - 提交图标与启动页素材到assets并执行生成命令；应用签名与商店元信息上传。
  - 更丰富的列表动画与复杂交互（非MVP范围）。

#### 3.6.2 动画和交互重点
- 页面转场动画（仿iOS）
- Facebook风格的列表滚动动画
- 按钮点击效果（Facebook + iOS混合风格）
- 加载状态动画
- 错误状态动画
- 手势操作动画

## 4. 敏捷实践

### 4.1 Daily Standup (每日站会)
由于是个人项目，建议每日进行自我检查：
- 昨天完成了什么？
- 今天计划做什么？
- 遇到什么阻碍？

### 4.2 Sprint Planning (Sprint计划会)
每个Sprint开始前：
1. 回顾上个Sprint的成果
2. 从Product Backlog选择本Sprint的Story
3. 将Story分解为具体任务
4. 估算工作量和时间

### 4.3 Sprint Review (Sprint评审)
每个Sprint结束时：
1. 演示完成的功能
2. 收集反馈
3. 更新Product Backlog

### 4.4 Sprint Retrospective (Sprint回顾)
每个Sprint结束后：
1. 分析什么做得好
2. 识别改进机会
3. 制定下个Sprint的改进计划

## 5. 风险管理

### 5.1 技术风险
| 风险 | 影响 | 概率 | 缓解策略 |
|------|------|------|----------|
| Flutter性能问题 | 高 | 中 | 早期原型验证，性能测试 |
| 第三方库兼容性 | 中 | 低 | 选择成熟稳定的库，有备选方案 |
| iOS动效实现难度 | 中 | 中 | 分阶段实现，先基础后高级 |

### 5.2 进度风险
| 风险 | 影响 | 概率 | 缓解策略 |
|------|------|------|----------|
| 功能复杂度超预期 | 高 | 中 | MVP优先，功能分阶段交付 |
| 时间估算不准确 | 中 | 高 | 基于历史数据调整，留缓冲时间 |
| 需求变更 | 中 | 低 | 明确需求优先级，控制范围 |

### 5.3 质量风险
| 风险 | 影响 | 概率 | 缓解策略 |
|------|------|------|----------|
| 测试覆盖率不足 | 高 | 中 | TDD开发，自动化测试 |
| 代码质量问题 | 中 | 低 | 代码规范，静态分析 |
| 性能不达标 | 高 | 低 | 持续性能监控，优化 |

## 6. 定义完成标准 (Definition of Done)

### 6.1 Feature级别DoD
- [ ] 功能实现符合验收标准
- [ ] 单元测试编写并通过
- [ ] Widget测试通过
- [ ] 代码Review完成
- [ ] 静态代码分析通过
- [ ] 文档更新完成

### 6.2 Sprint级别DoD
- [ ] 所有Story达到Feature级DoD
- [ ] 集成测试通过
- [ ] 性能测试通过
- [ ] 用户体验验收通过
- [ ] Sprint演示完成

### 6.3 Release级别DoD
- [ ] 所有功能测试通过
- [ ] 性能指标达标
- [ ] 安全测试通过
- [ ] 发布包构建成功
- [ ] 发布文档完成

## 7. 估算和计划

### 7.1 Story Point估算基准
- **1 SP**: 简单配置或小修改（1-2小时）
- **3 SP**: 简单功能实现（半天）
- **5 SP**: 中等复杂度功能（1天）
- **8 SP**: 复杂功能（2天）
- **13 SP**: 非常复杂功能（3-4天）
- **21 SP**: 需要分解的大功能

### 7.2 团队速度 (Velocity)
基于个人项目的估算：
- **每日可用时间**: 4小时
- **每Sprint可用时间**: 56小时（14天 × 4小时）
- **预期速度**: 35-40 Story Points per Sprint

### 7.3 燃尽图跟踪
每个Sprint维护燃尽图，跟踪：
- 剩余Story Points
- 理想燃尽线
- 实际进度线
- 风险预警

## 8. 工具和环境

### 8.1 开发工具
- **IDE**: VS Code + Flutter扩展
- **版本控制**: Git + GitHub
- **项目管理**: GitHub Issues + Projects
- **文档**: Markdown + GitHub Wiki

### 8.2 测试工具
- **单元测试**: flutter_test
- **集成测试**: integration_test
- **代码覆盖**: lcov
- **性能测试**: Flutter Inspector

### 8.3 CI/CD
- **持续集成**: GitHub Actions
- **代码质量**: dart analyze + flutter_lints
- **自动测试**: 每次提交触发
- **发布构建**: 标签触发发布包构建

---

## 9. Facebook风格UI设计适配详细说明

### 9.1 设计理念调整
**原开发策略**: 数据驱动 → UI实现
**新开发策略**: UI优先 → 数据集成

这种调整让我们能够：
- 更早地建立视觉标准和用户体验
- 快速进行界面原型验证
- 为后续功能开发提供美观的界面框架

### 9.2 Facebook首页完全照抄要求

#### 9.2.1 布局结构 (必须完全一致)
```
┌───────────────────────────────────────────────────────────────────────────┐
│ [f] facebook    [🔍 搜索朋友、帖子、照片等...]     [⚡][💬][🔔] [👤▼] │
├───────────────────────────────────────────────────────────────────────────┤
│ 左栏 (240px)      │         主内容区 (590px)         │  右栏 (280px)    │
│                 │                                   │                     │
│ 🏠 主页           │ ┌─────────────────────────────────┐ │ 📞 联系人           │
│ 👥 朋友           │ │  [👤] 你在想什么？             │ │ ● 在线好友列表       │
│ 📺 观看           │ │  ────────────────────────────── │ │                     │
│ 🏪 市场           │ │  [📷 照片/视频] [😊 感受] [📍]   │ │ 📰 推荐页面         │
│ 👥 群组           │ └─────────────────────────────────┘ │ 📱 推荐应用         │
│ 等等...          │                                   │ 🎂 生日提醒         │
│                 │ [时间线内容卡片们...]              │ 📺 推荐视频         │
└───────────────────────────────────────────────────────────────────────────┘
```

#### 9.2.2 精确的尺寸规范
- **整体宽度**: 1200px (在大屏上居中)
- **顶部导航栏**: 高度44px，#1877F2背景
- **左侧栏宽度**: 240px，固定定位
- **主内容区宽度**: 590px，居中滚动
- **右侧栏宽度**: 280px，固定定位
- **卡片间距**: 16px垂直间距
- **内容边距**: 16px标准内边距

#### 9.2.3 颜色系统 (完全照抄)
```css
/* Facebook官方色彩规范 */
--fb-primary: #1877F2;      /* 主蓝色 */
--fb-primary-hover: #166FE5; /* 悬停蓝色 */
--fb-background: #F0F2F5;    /* 背景灰色 */
--fb-surface: #FFFFFF;       /* 卡片白色 */
--fb-border: #E4E6EA;        /* 边框颜色 */
--fb-text-primary: #050505;  /* 主要文字 */
--fb-text-secondary: #65676B; /* 次要文字 */
--fb-text-disabled: #BCC0C4; /* 禁用文字 */
--fb-success: #42B883;       /* 成功绿色 */
--fb-shadow: rgba(0,0,0,0.1); /* 卡片阴影 */
```

#### 9.2.4 组件规范 (逐一对照实现)
**顶部导航栏组件:**
- 高度: 44px
- 背景: #1877F2
- Logo: 32px白色 "f" 图标
- 搜索框: 240px宽，圆角20px，#E4E6EA边框
- 右侧图标: 40px圆形按钮，16px图标

**卡片组件:**
- 圆角: 8px
- 边框: 1px solid #E4E6EA
- 阴影: 0 1px 2px rgba(0,0,0,0.1)
- 内边距: 16px
- 背景: #FFFFFF

**按钮组件:**
- 主要按钮: #1877F2背景，圆角6px，字体14px
- 次要按钮: #E4E6EA背景，圆角6px
- 图标按钮: 36px圆形，悬停显示#F0F2F5背景

### 9.3 日记应用的Facebook风格适配

#### 9.3.1 功能映射
| Facebook元素 | 日记应用适配 | 保留风格 |
|-------------|-------------|----------|
| "你在想什么？" | "今天你想记录什么？" | ✅ 完全保留输入框样式 |
| 动态卡片 | 日记卡片 | ✅ 相同的卡片设计 |
| 用户头像 | 日记图标/心情图标 | ✅ 圆形头像风格 |
| 点赞评论分享 | 标记有用/编辑/删除 | ✅ 相同的按钮布局 |
| 朋友列表 | 标签列表 | ✅ 列表项设计 |
| 通知图标 | 统计/设置图标 | ✅ 图标按钮风格 |

#### 9.3.2 左侧导航适配
```
原Facebook导航     →     日记应用导航
🏠 主页            →     🏠 主页
👥 朋友            →     📝 我的日记
📺 观看            →     🏷️ 标签管理
🏪 市场            →     ⭐ 收藏夹
👥 群组            →     📊 统计分析
🎮 游戏            →     🔍 高级搜索
📄 页面            →     📤 导出数据
📅 活动            →     ⚙️ 设置
```

#### 9.3.3 右侧栏适配
```
原Facebook右侧栏   →     日记应用右侧栏
📞 联系人          →     🏷️ 常用标签
● 在线好友         →     📊 写作统计
📰 你可能认识      →     💡 写作提示
🎂 生日提醒        →     🔄 历史上的今天
📺 推荐视频        →     📈 数据图表
```

### 9.4 实现优先级 (Sprint 2重点)

#### 9.4.1 第一优先级 (必须100%还原)
1. **整体布局框架** - 三栏布局，精确尺寸
2. **顶部导航栏** - 完全按Facebook样式
3. **卡片组件** - 阴影、圆角、间距完全一致
4. **色彩系统** - 使用Facebook官方色值
5. **发布输入框** - "你在想什么？"风格适配

#### 9.4.2 第二优先级 (保持风格一致)
1. **左侧导航菜单** - 图标和悬停效果
2. **右侧栏组件** - 列表项和标题样式
3. **按钮系统** - 主要、次要、图标按钮
4. **字体系统** - Helvetica字体栈

#### 9.4.3 第三优先级 (功能性适配)
1. **响应式断点** - 适配移动端
2. **主题切换** - 暗色模式适配
3. **动画效果** - 悬停和点击效果

### 9.5 质量标准

#### 9.5.1 视觉还原度标准
- **100%还原**: 布局、尺寸、颜色、圆角、阴影
- **95%还原**: 字体、图标、间距
- **90%还原**: 悬停效果、过渡动画
- **85%还原**: 响应式适配

#### 9.5.2 验收标准
- [ ] 与Facebook首页截图进行像素级对比
- [ ] 所有主要组件通过设计审查
- [ ] 响应式布局在多设备测试通过
- [ ] 色彩对比度符合WCAG 2.1 AA标准
- [ ] 动画效果流畅，60fps

### 9.6 开发注意事项

#### 9.6.1 技术实现要点
- 使用Flutter的`Container`和`BoxDecoration`精确控制样式
- 利用`Theme`系统管理Facebook色彩方案
- 使用`CustomScrollView`实现时间线滚动效果
- 采用`AnimatedContainer`实现悬停动画

#### 9.6.2 避免的常见错误
- ❌ 使用Material Design默认样式
- ❌ 随意调整Facebook的尺寸规范
- ❌ 使用非Facebook官方色彩
- ❌ 忽略细节如阴影和圆角
- ❌ 不考虑不同屏幕尺寸的适配

---

**文档版本**: v2.0 (UI优先策略)
**创建日期**: 2025-09-22
**最后更新**: 2025-09-22
**作者**: 成东杰
